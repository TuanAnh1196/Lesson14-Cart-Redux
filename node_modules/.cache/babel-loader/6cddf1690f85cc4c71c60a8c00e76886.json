{"ast":null,"code":"import * as types from './../constants/ActionTypes';\nvar data = JSON.parse(localStorage.getItem('CART'));\nvar initialState = data ? data : [];\n\nconst cart = (state = initialState, action) => {\n  var product = action.product,\n      quantity = action.quantity;\n  var index = -1; //khong tim thay\n\n  switch (action.type) {\n    case types.ADD_TO_CART:\n      index = findProductInCart(state, product);\n\n      if (index !== -1) {\n        state[index].quantity += quantity; //neu co roi thi tang so luong\n      } else {\n        state.push({\n          product,\n          quantity\n        });\n      } // localStorage.setItem('CART', JSON.stringify(state));\n\n\n      return [...state];\n\n    case types.DELETE_PRODUCT_IN_CART:\n      index = findProductInCart(state, product);\n\n      if (index !== -1) {\n        state.splice(index, 1);\n      } // localStorage.setItem('CART', JSON.stringify(state));\n\n\n      return [...state];\n\n    case types.UPDATE_PRODUCT_IN_CART:\n      index = findProductInCart(state, product);\n\n      if (index !== -1) {\n        state[index].quantity = quantity;\n      } // localStorage.setItem('CART', JSON.stringify(state));\n\n\n      return state;\n\n    default:\n      return [...state];\n  }\n};\n\nvar findProductInCart = (cart, product) => {\n  var index = -1;\n\n  if (cart.length > 0) {\n    for (var i = 0; i < cart.length; i++) {\n      if (cart[i].product.id === product.id) {\n        index = i;\n        break;\n      }\n    }\n  }\n\n  return index;\n};\n\nexport default cart;","map":{"version":3,"sources":["/Users/tinhphan/Workspace/PSCD/Training/reactjs/tuan-anh/Lesson14-Cart-Redux/src/reducers/cart.js"],"names":["types","data","JSON","parse","localStorage","getItem","initialState","cart","state","action","product","quantity","index","type","ADD_TO_CART","findProductInCart","push","DELETE_PRODUCT_IN_CART","splice","UPDATE_PRODUCT_IN_CART","length","i","id"],"mappings":"AAAA,OAAO,KAAKA,KAAZ,MAAuB,4BAAvB;AAEA,IAAIC,IAAI,GAAGC,IAAI,CAACC,KAAL,CAAWC,YAAY,CAACC,OAAb,CAAqB,MAArB,CAAX,CAAX;AACA,IAAIC,YAAY,GAAGL,IAAI,GAAGA,IAAH,GAAU,EAAjC;;AAEA,MAAMM,IAAI,GAAG,CAACC,KAAK,GAAGF,YAAT,EAAuBG,MAAvB,KAAkC;AAAA,MACvCC,OADuC,GACjBD,MADiB,CACvCC,OADuC;AAAA,MAC9BC,QAD8B,GACjBF,MADiB,CAC9BE,QAD8B;AAE7C,MAAIC,KAAK,GAAG,CAAC,CAAb,CAF6C,CAE7B;;AAChB,UAAQH,MAAM,CAACI,IAAf;AACE,SAAKb,KAAK,CAACc,WAAX;AACEF,MAAAA,KAAK,GAAGG,iBAAiB,CAACP,KAAD,EAAQE,OAAR,CAAzB;;AACA,UAAIE,KAAK,KAAK,CAAC,CAAf,EAAkB;AAChBJ,QAAAA,KAAK,CAACI,KAAD,CAAL,CAAaD,QAAb,IAAyBA,QAAzB,CADgB,CACmB;AACpC,OAFD,MAEO;AACLH,QAAAA,KAAK,CAACQ,IAAN,CAAW;AACTN,UAAAA,OADS;AAETC,UAAAA;AAFS,SAAX;AAID,OATH,CAUE;;;AACA,aAAO,CAAC,GAAGH,KAAJ,CAAP;;AACF,SAAKR,KAAK,CAACiB,sBAAX;AACEL,MAAAA,KAAK,GAAGG,iBAAiB,CAACP,KAAD,EAAQE,OAAR,CAAzB;;AACA,UAAIE,KAAK,KAAK,CAAC,CAAf,EAAkB;AAChBJ,QAAAA,KAAK,CAACU,MAAN,CAAaN,KAAb,EAAoB,CAApB;AACD,OAJH,CAKE;;;AACA,aAAO,CAAC,GAAGJ,KAAJ,CAAP;;AAEF,SAAKR,KAAK,CAACmB,sBAAX;AACEP,MAAAA,KAAK,GAAGG,iBAAiB,CAACP,KAAD,EAAQE,OAAR,CAAzB;;AACA,UAAIE,KAAK,KAAK,CAAC,CAAf,EAAkB;AAChBJ,QAAAA,KAAK,CAACI,KAAD,CAAL,CAAaD,QAAb,GAAwBA,QAAxB;AACD,OAJH,CAKE;;;AACA,aAAOH,KAAP;;AACF;AAAS,aAAO,CAAC,GAAGA,KAAJ,CAAP;AA5BX;AA8BD,CAjCD;;AAkCA,IAAIO,iBAAiB,GAAG,CAACR,IAAD,EAAOG,OAAP,KAAmB;AAEzC,MAAIE,KAAK,GAAG,CAAC,CAAb;;AACA,MAAIL,IAAI,CAACa,MAAL,GAAc,CAAlB,EAAqB;AACnB,SAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGd,IAAI,CAACa,MAAzB,EAAiCC,CAAC,EAAlC,EAAsC;AACpC,UAAId,IAAI,CAACc,CAAD,CAAJ,CAAQX,OAAR,CAAgBY,EAAhB,KAAuBZ,OAAO,CAACY,EAAnC,EAAuC;AACrCV,QAAAA,KAAK,GAAGS,CAAR;AACA;AACD;AACF;AACF;;AACD,SAAOT,KAAP;AACD,CAZD;;AAaA,eAAeL,IAAf","sourcesContent":["import * as types from './../constants/ActionTypes';\n\nvar data = JSON.parse(localStorage.getItem('CART'));\nvar initialState = data ? data : [];\n\nconst cart = (state = initialState, action) => {\n  var { product, quantity } = action;\n  var index = -1; //khong tim thay\n  switch (action.type) {\n    case types.ADD_TO_CART:\n      index = findProductInCart(state, product);\n      if (index !== -1) {\n        state[index].quantity += quantity; //neu co roi thi tang so luong\n      } else {\n        state.push({\n          product,\n          quantity\n        });\n      }\n      // localStorage.setItem('CART', JSON.stringify(state));\n      return [...state];\n    case types.DELETE_PRODUCT_IN_CART:\n      index = findProductInCart(state, product);\n      if (index !== -1) {\n        state.splice(index, 1);\n      }\n      // localStorage.setItem('CART', JSON.stringify(state));\n      return [...state];\n\n    case types.UPDATE_PRODUCT_IN_CART:\n      index = findProductInCart(state, product);\n      if (index !== -1) {\n        state[index].quantity = quantity;\n      }\n      // localStorage.setItem('CART', JSON.stringify(state));\n      return state;\n    default: return [...state];\n  }\n}\nvar findProductInCart = (cart, product) => {\n\n  var index = -1;\n  if (cart.length > 0) {\n    for (var i = 0; i < cart.length; i++) {\n      if (cart[i].product.id === product.id) {\n        index = i;\n        break;\n      }\n    }\n  }\n  return index;\n}\nexport default cart;\n"]},"metadata":{},"sourceType":"module"}