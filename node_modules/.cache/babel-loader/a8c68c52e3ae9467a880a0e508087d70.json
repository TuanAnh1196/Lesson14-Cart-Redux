{"ast":null,"code":"import _defineProperty from \"/Users/tinhphan/Workspace/PSCD/Training/reactjs/tuan-anh/Lesson14-Cart-Redux/node_modules/@babel/runtime/helpers/esm/defineProperty\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(source, true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(source).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport * as types from './../constants/ActionTypes';\nvar data = JSON.parse(localStorage.getItem('CART'));\nvar initialState = data ? data : [];\n\nconst cart = (state = initialState, action) => {\n  var product = action.product,\n      quantity = action.quantity;\n  var index = -1; //khong tim thay\n\n  switch (action.type) {\n    case types.ADD_TO_CART:\n      index = findProductInCart(state, product);\n\n      if (index !== -1) {\n        state[index].quantity += quantity; //neu co roi thi tang so luong\n      } else {\n        state.push({\n          product,\n          quantity\n        });\n      } // localStorage.setItem('CART', JSON.stringify(state));\n\n\n      return [...state];\n\n    case types.DELETE_PRODUCT_IN_CART:\n      index = findProductInCart(state, product);\n\n      if (index !== -1) {\n        state.splice(index, 1);\n      } // localStorage.setItem('CART', JSON.stringify(state));\n\n\n      return [...state];\n\n    case types.UPDATE_PRODUCT_IN_CART:\n      index = findProductInCart(state, product);\n\n      if (index !== -1) {\n        state[index] = _objectSpread({}, state[index], {\n          quantity\n        }); // state[index].quantity = quantity;\n      } // localStorage.setItem('CART', JSON.stringify(state));\n\n\n      return [...state];\n\n    default:\n      return [...state];\n  }\n};\n\nvar findProductInCart = (cart, product) => {\n  var index = -1;\n\n  if (cart.length > 0) {\n    for (var i = 0; i < cart.length; i++) {\n      if (cart[i].product.id === product.id) {\n        index = i;\n        break;\n      }\n    }\n  }\n\n  return index;\n};\n\nexport default cart;","map":{"version":3,"sources":["/Users/tinhphan/Workspace/PSCD/Training/reactjs/tuan-anh/Lesson14-Cart-Redux/src/reducers/cart.js"],"names":["types","data","JSON","parse","localStorage","getItem","initialState","cart","state","action","product","quantity","index","type","ADD_TO_CART","findProductInCart","push","DELETE_PRODUCT_IN_CART","splice","UPDATE_PRODUCT_IN_CART","length","i","id"],"mappings":";;;;;;AAAA,OAAO,KAAKA,KAAZ,MAAuB,4BAAvB;AAEA,IAAIC,IAAI,GAAGC,IAAI,CAACC,KAAL,CAAWC,YAAY,CAACC,OAAb,CAAqB,MAArB,CAAX,CAAX;AACA,IAAIC,YAAY,GAAGL,IAAI,GAAGA,IAAH,GAAU,EAAjC;;AAEA,MAAMM,IAAI,GAAG,CAACC,KAAK,GAAGF,YAAT,EAAuBG,MAAvB,KAAkC;AAAA,MACrCC,OADqC,GAChBD,MADgB,CACrCC,OADqC;AAAA,MAC5BC,QAD4B,GAChBF,MADgB,CAC5BE,QAD4B;AAE3C,MAAIC,KAAK,GAAG,CAAC,CAAb,CAF2C,CAE3B;;AAChB,UAAQH,MAAM,CAACI,IAAf;AACI,SAAKb,KAAK,CAACc,WAAX;AACIF,MAAAA,KAAK,GAAGG,iBAAiB,CAACP,KAAD,EAAOE,OAAP,CAAzB;;AACA,UAAGE,KAAK,KAAK,CAAC,CAAd,EAAgB;AACZJ,QAAAA,KAAK,CAACI,KAAD,CAAL,CAAaD,QAAb,IAAyBA,QAAzB,CADY,CACuB;AACtC,OAFD,MAEK;AACDH,QAAAA,KAAK,CAACQ,IAAN,CAAW;AACPN,UAAAA,OADO;AAEPC,UAAAA;AAFO,SAAX;AAIH,OATL,CAUI;;;AACA,aAAO,CAAC,GAAGH,KAAJ,CAAP;;AACJ,SAAKR,KAAK,CAACiB,sBAAX;AACIL,MAAAA,KAAK,GAAGG,iBAAiB,CAACP,KAAD,EAAOE,OAAP,CAAzB;;AACA,UAAGE,KAAK,KAAG,CAAC,CAAZ,EAAc;AACVJ,QAAAA,KAAK,CAACU,MAAN,CAAaN,KAAb,EAAmB,CAAnB;AACH,OAJL,CAKI;;;AACA,aAAO,CAAC,GAAGJ,KAAJ,CAAP;;AAEJ,SAAKR,KAAK,CAACmB,sBAAX;AACIP,MAAAA,KAAK,GAAGG,iBAAiB,CAACP,KAAD,EAAOE,OAAP,CAAzB;;AACA,UAAGE,KAAK,KAAG,CAAC,CAAZ,EAAc;AACZJ,QAAAA,KAAK,CAACI,KAAD,CAAL,qBACKJ,KAAK,CAACI,KAAD,CADV;AAEED,UAAAA;AAFF,WADY,CAKV;AACH,OARL,CASI;;;AACA,aAAO,CAAC,GAAGH,KAAJ,CAAP;;AACJ;AAAS,aAAO,CAAC,GAAGA,KAAJ,CAAP;AAhCb;AAkCH,CArCD;;AAsCA,IAAIO,iBAAiB,GAAG,CAACR,IAAD,EAAMG,OAAN,KAAiB;AAErC,MAAIE,KAAK,GAAG,CAAC,CAAb;;AACA,MAAGL,IAAI,CAACa,MAAL,GAAa,CAAhB,EAAkB;AACd,SAAI,IAAIC,CAAC,GAAC,CAAV,EAAYA,CAAC,GAACd,IAAI,CAACa,MAAnB,EAA0BC,CAAC,EAA3B,EAA8B;AAC1B,UAAGd,IAAI,CAACc,CAAD,CAAJ,CAAQX,OAAR,CAAgBY,EAAhB,KAAuBZ,OAAO,CAACY,EAAlC,EAAqC;AACjCV,QAAAA,KAAK,GAAGS,CAAR;AACA;AACH;AACJ;AACJ;;AACD,SAAOT,KAAP;AACH,CAZD;;AAaA,eAAeL,IAAf","sourcesContent":["import * as types from './../constants/ActionTypes';\n\nvar data = JSON.parse(localStorage.getItem('CART'));\nvar initialState = data ? data : [];\n\nconst cart = (state = initialState, action) => {\n    var { product, quantity} = action;\n    var index = -1; //khong tim thay\n    switch (action.type) {\n        case types.ADD_TO_CART:\n            index = findProductInCart(state,product);\n            if(index !== -1){\n                state[index].quantity += quantity; //neu co roi thi tang so luong\n            }else{\n                state.push({\n                    product,\n                    quantity\n                });\n            }\n            // localStorage.setItem('CART', JSON.stringify(state));\n            return [...state];\n        case types.DELETE_PRODUCT_IN_CART:\n            index = findProductInCart(state,product);\n            if(index!==-1){\n                state.splice(index,1);\n            }\n            // localStorage.setItem('CART', JSON.stringify(state));\n            return [...state];\n\n        case types.UPDATE_PRODUCT_IN_CART:\n            index = findProductInCart(state,product);\n            if(index!==-1){\n              state[index] = {\n                ...state[index],\n                quantity\n              }\n                // state[index].quantity = quantity;\n            }\n            // localStorage.setItem('CART', JSON.stringify(state));\n            return [...state];\n        default: return [...state];\n    }\n}\nvar findProductInCart = (cart,product) =>{\n\n    var index = -1;\n    if(cart.length >0){\n        for(var i=0;i<cart.length;i++){\n            if(cart[i].product.id === product.id){\n                index = i;\n                break;\n            }\n        }\n    }\n    return index;\n}\nexport default cart;\n"]},"metadata":{},"sourceType":"module"}